12/02/2025 08:24:49 - INFO - training.fm_trainer - Starting training
12/02/2025 08:24:49 - INFO - training.fm_trainer -   Max steps: 210000
12/02/2025 08:24:49 - INFO - training.fm_trainer -   Global batch size: 128
12/02/2025 08:24:49 - INFO - training.fm_trainer -   Gradient accumulation steps: 32
12/02/2025 08:24:49 - INFO - data.data_loader - Including The Stack v1 datasets (RECOMMENDED):
- Contains actual code content directly
- No AWS credentials needed
- Just login with: huggingface-cli login
See: https://huggingface.co/datasets/bigcode/the-stack-dedup
12/02/2025 08:24:49 - INFO - data.data_loader - Loading dataset: dclm-baseline from mlfoundations/dclm-baseline-1.0
Resolving data files: 100%|████████████████████████████████████████████████████████| 27838/27838 [00:00<00:00, 69741.47it/s]
12/02/2025 08:31:47 - INFO - data.data_loader - ✓ Loaded dclm-baseline with weight 60.17
12/02/2025 08:31:47 - INFO - data.data_loader - Loading dataset: openwebmath from open-web-math/open-web-math
Traceback (most recent call last):
  File "/root/miniconda3/lib/python3.13/site-packages/huggingface_hub/utils/_http.py", line 402, in hf_raise_for_status
    response.raise_for_status()
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/root/miniconda3/lib/python3.13/site-packages/requests/models.py", line 1026, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 404 Client Error: Not Found for url: https://huggingface.co/datasets/open-web-math/open-web-math/resolve/fde8ef8de2300f5e778f56261843dab89f230815/open-web-math.py

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/root/miniconda3/lib/python3.13/site-packages/datasets/load.py", line 987, in dataset_module_factory
    api.hf_hub_download(
    ~~~~~~~~~~~~~~~~~~~^
        repo_id=path,
        ^^^^^^^^^^^^^
    ...<3 lines>...
        proxies=download_config.proxies,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/root/miniconda3/lib/python3.13/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn
    return fn(*args, **kwargs)
  File "/root/miniconda3/lib/python3.13/site-packages/huggingface_hub/hf_api.py", line 5467, in hf_hub_download
    return hf_hub_download(
        repo_id=repo_id,
    ...<18 lines>...
        local_files_only=local_files_only,
    )
  File "/root/miniconda3/lib/python3.13/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn
    return fn(*args, **kwargs)
  File "/root/miniconda3/lib/python3.13/site-packages/huggingface_hub/file_download.py", line 1007, in hf_hub_download
    return _hf_hub_download_to_cache_dir(
        # Destination
    ...<14 lines>...
        force_download=force_download,
    )
  File "/root/miniconda3/lib/python3.13/site-packages/huggingface_hub/file_download.py", line 1070, in _hf_hub_download_to_cache_dir
    (url_to_download, etag, commit_hash, expected_size, xet_file_data, head_call_error) = _get_metadata_or_catch_error(
                                                                                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        repo_id=repo_id,
        ^^^^^^^^^^^^^^^^
    ...<10 lines>...
        relative_filename=relative_filename,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/root/miniconda3/lib/python3.13/site-packages/huggingface_hub/file_download.py", line 1543, in _get_metadata_or_catch_error
    metadata = get_hf_file_metadata(
        url=url, proxies=proxies, timeout=etag_timeout, headers=headers, token=token, endpoint=endpoint
    )
  File "/root/miniconda3/lib/python3.13/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn
    return fn(*args, **kwargs)
  File "/root/miniconda3/lib/python3.13/site-packages/huggingface_hub/file_download.py", line 1460, in get_hf_file_metadata
    r = _request_wrapper(
        method="HEAD",
    ...<5 lines>...
        timeout=timeout,
    )
  File "/root/miniconda3/lib/python3.13/site-packages/huggingface_hub/file_download.py", line 283, in _request_wrapper
    response = _request_wrapper(
        method=method,
    ...<2 lines>...
        **params,
    )
  File "/root/miniconda3/lib/python3.13/site-packages/huggingface_hub/file_download.py", line 307, in _request_wrapper
    hf_raise_for_status(response)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/root/miniconda3/lib/python3.13/site-packages/huggingface_hub/utils/_http.py", line 413, in hf_raise_for_status
    raise _format(EntryNotFoundError, message, response) from e
huggingface_hub.errors.EntryNotFoundError: 404 Client Error. (Request ID: Root=1-692ea3f4-0a68b5743337f06a42b2c5b4;b1af7192-7238-4048-a591-73596cc6c8f5)

Entry Not Found for url: https://huggingface.co/datasets/open-web-math/open-web-math/resolve/fde8ef8de2300f5e778f56261843dab89f230815/open-web-math.py.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/workspace/flow-matching/CoDA/flow-matching-qwen/training/train_h100.py", line 305, in <module>
    main()
    ~~~~^^
  File "/workspace/flow-matching/CoDA/flow-matching-qwen/training/train_h100.py", line 301, in main
    trainer.train()
    ~~~~~~~~~~~~~^^
  File "/workspace/flow-matching/CoDA/flow-matching-qwen/training/fm_trainer.py", line 346, in train
    batch = next(train_iterator)
  File "/root/miniconda3/lib/python3.13/site-packages/accelerate/data_loader.py", line 866, in __iter__
    next_batch, next_batch_info = self._fetch_batches(main_iterator)
                                  ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.13/site-packages/accelerate/data_loader.py", line 820, in _fetch_batches
    batches.append(next(iterator))
                   ~~~~^^^^^^^^^^
  File "/root/miniconda3/lib/python3.13/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
  File "/root/miniconda3/lib/python3.13/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/root/miniconda3/lib/python3.13/site-packages/torch/utils/data/_utils/fetch.py", line 33, in fetch
    data.append(next(self.dataset_iter))
                ~~~~^^^^^^^^^^^^^^^^^^^
  File "/workspace/flow-matching/CoDA/flow-matching-qwen/data/data_loader.py", line 416, in __iter__
    dataset = self._get_dataset()
  File "/workspace/flow-matching/CoDA/flow-matching-qwen/data/data_loader.py", line 364, in _get_dataset
    self._dataset = create_pretrain_mixture(
                    ~~~~~~~~~~~~~~~~~~~~~~~^
        self.tokenizer,
        ^^^^^^^^^^^^^^^
    ...<3 lines>...
        self.seed + self.worker_id,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/workspace/flow-matching/CoDA/flow-matching-qwen/data/data_loader.py", line 300, in create_pretrain_mixture
    ds = load_single_dataset(config, tokenizer, max_length)
  File "/workspace/flow-matching/CoDA/flow-matching-qwen/data/data_loader.py", line 197, in load_single_dataset
    ds = load_dataset(
        config.path,
        **load_kwargs,
    )
  File "/root/miniconda3/lib/python3.13/site-packages/datasets/load.py", line 1397, in load_dataset
    builder_instance = load_dataset_builder(
        path=path,
    ...<10 lines>...
        **config_kwargs,
    )
  File "/root/miniconda3/lib/python3.13/site-packages/datasets/load.py", line 1137, in load_dataset_builder
    dataset_module = dataset_module_factory(
        path,
    ...<5 lines>...
        cache_dir=cache_dir,
    )
  File "/root/miniconda3/lib/python3.13/site-packages/datasets/load.py", line 1009, in dataset_module_factory
    ).get_module()
      ~~~~~~~~~~^^
  File "/root/miniconda3/lib/python3.13/site-packages/datasets/load.py", line 609, in get_module
    exported_dataset_infos = _dataset_viewer.get_exported_dataset_infos(
        dataset=self.name, commit_hash=self.commit_hash, token=self.download_config.token
    )
  File "/root/miniconda3/lib/python3.13/site-packages/datasets/utils/_dataset_viewer.py", line 71, in get_exported_dataset_infos
    info_response = get_session().get(
        url=dataset_viewer_info_url + dataset,
        headers=get_authentication_headers_for_url(config.HF_ENDPOINT + f"datasets/{dataset}", token=token),
        timeout=100.0,
    )
  File "/root/miniconda3/lib/python3.13/site-packages/requests/sessions.py", line 602, in get
    return self.request("GET", url, **kwargs)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.13/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/root/miniconda3/lib/python3.13/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/root/miniconda3/lib/python3.13/site-packages/huggingface_hub/utils/_http.py", line 95, in send
    return super().send(request, *args, **kwargs)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.13/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
        method=request.method,
    ...<9 lines>...
        chunked=chunked,
    )
  File "/root/miniconda3/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/root/miniconda3/lib/python3.13/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
    ~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/root/miniconda3/lib/python3.13/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
    ~~~~~~~~~~~~^^
  File "/root/miniconda3/lib/python3.13/site-packages/urllib3/connection.py", line 753, in connect
    self.sock = sock = self._new_conn()
                       ~~~~~~~~~~~~~~^^
  File "/root/miniconda3/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/root/miniconda3/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
KeyboardInterrupt
[rank0]: Traceback (most recent call last):
[rank0]:   File "/root/miniconda3/lib/python3.13/site-packages/huggingface_hub/utils/_http.py", line 402, in hf_raise_for_status
[rank0]:     response.raise_for_status()
[rank0]:     ~~~~~~~~~~~~~~~~~~~~~~~~~^^
[rank0]:   File "/root/miniconda3/lib/python3.13/site-packages/requests/models.py", line 1026, in raise_for_status
[rank0]:     raise HTTPError(http_error_msg, response=self)
[rank0]: requests.exceptions.HTTPError: 404 Client Error: Not Found for url: https://huggingface.co/datasets/open-web-math/open-web-math/resolve/fde8ef8de2300f5e778f56261843dab89f230815/open-web-math.py

[rank0]: The above exception was the direct cause of the following exception:

[rank0]: Traceback (most recent call last):
[rank0]:   File "/root/miniconda3/lib/python3.13/site-packages/datasets/load.py", line 987, in dataset_module_factory
[rank0]:     api.hf_hub_download(
[rank0]:     ~~~~~~~~~~~~~~~~~~~^
[rank0]:         repo_id=path,
[rank0]:         ^^^^^^^^^^^^^
[rank0]:     ...<3 lines>...
[rank0]:         proxies=download_config.proxies,
[rank0]:         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:     )
[rank0]:     ^
[rank0]:   File "/root/miniconda3/lib/python3.13/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn
[rank0]:     return fn(*args, **kwargs)
[rank0]:   File "/root/miniconda3/lib/python3.13/site-packages/huggingface_hub/hf_api.py", line 5467, in hf_hub_download
[rank0]:     return hf_hub_download(
[rank0]:         repo_id=repo_id,
[rank0]:     ...<18 lines>...
[rank0]:         local_files_only=local_files_only,
[rank0]:     )
[rank0]:   File "/root/miniconda3/lib/python3.13/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn
[rank0]:     return fn(*args, **kwargs)
[rank0]:   File "/root/miniconda3/lib/python3.13/site-packages/huggingface_hub/file_download.py", line 1007, in hf_hub_download
[rank0]:     return _hf_hub_download_to_cache_dir(
[rank0]:         # Destination
[rank0]:     ...<14 lines>...
[rank0]:         force_download=force_download,
[rank0]:     )
[rank0]:   File "/root/miniconda3/lib/python3.13/site-packages/huggingface_hub/file_download.py", line 1070, in _hf_hub_download_to_cache_dir
[rank0]:     (url_to_download, etag, commit_hash, expected_size, xet_file_data, head_call_error) = _get_metadata_or_catch_error(
[rank0]:                                                                                           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
[rank0]:         repo_id=repo_id,
[rank0]:         ^^^^^^^^^^^^^^^^
[rank0]:     ...<10 lines>...
[rank0]:         relative_filename=relative_filename,
[rank0]:         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:     )
[rank0]:     ^
[rank0]:   File "/root/miniconda3/lib/python3.13/site-packages/huggingface_hub/file_download.py", line 1543, in _get_metadata_or_catch_error
[rank0]:     metadata = get_hf_file_metadata(
[rank0]:         url=url, proxies=proxies, timeout=etag_timeout, headers=headers, token=token, endpoint=endpoint
[rank0]:     )
[rank0]:   File "/root/miniconda3/lib/python3.13/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn
[rank0]:     return fn(*args, **kwargs)
[rank0]:   File "/root/miniconda3/lib/python3.13/site-packages/huggingface_hub/file_download.py", line 1460, in get_hf_file_metadata
[rank0]:     r = _request_wrapper(
[rank0]:         method="HEAD",
[rank0]:     ...<5 lines>...
[rank0]:         timeout=timeout,
[rank0]:     )
[rank0]:   File "/root/miniconda3/lib/python3.13/site-packages/huggingface_hub/file_download.py", line 283, in _request_wrapper
[rank0]:     response = _request_wrapper(
[rank0]:         method=method,
[rank0]:     ...<2 lines>...
[rank0]:         **params,
[rank0]:     )
[rank0]:   File "/root/miniconda3/lib/python3.13/site-packages/huggingface_hub/file_download.py", line 307, in _request_wrapper
[rank0]:     hf_raise_for_status(response)
[rank0]:     ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
[rank0]:   File "/root/miniconda3/lib/python3.13/site-packages/huggingface_hub/utils/_http.py", line 413, in hf_raise_for_status
[rank0]:     raise _format(EntryNotFoundError, message, response) from e
[rank0]: huggingface_hub.errors.EntryNotFoundError: 404 Client Error. (Request ID: Root=1-692ea3f4-0a68b5743337f06a42b2c5b4;b1af7192-7238-4048-a591-73596cc6c8f5)

[rank0]: Entry Not Found for url: https://huggingface.co/datasets/open-web-math/open-web-math/resolve/fde8ef8de2300f5e778f56261843dab89f230815/open-web-math.py.

[rank0]: During handling of the above exception, another exception occurred:

[rank0]: Traceback (most recent call last):
[rank0]:   File "/workspace/flow-matching/CoDA/flow-matching-qwen/training/train_h100.py", line 305, in <module>
[rank0]:     main()
[rank0]:     ~~~~^^
[rank0]:   File "/workspace/flow-matching/CoDA/flow-matching-qwen/training/train_h100.py", line 301, in main
[rank0]:     trainer.train()
[rank0]:     ~~~~~~~~~~~~~^^
[rank0]:   File "/workspace/flow-matching/CoDA/flow-matching-qwen/training/fm_trainer.py", line 346, in train
[rank0]:     batch = next(train_iterator)
[rank0]:   File "/root/miniconda3/lib/python3.13/site-packages/accelerate/data_loader.py", line 866, in __iter__
[rank0]:     next_batch, next_batch_info = self._fetch_batches(main_iterator)
[rank0]:                                   ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
[rank0]:   File "/root/miniconda3/lib/python3.13/site-packages/accelerate/data_loader.py", line 820, in _fetch_batches
[rank0]:     batches.append(next(iterator))
[rank0]:                    ~~~~^^^^^^^^^^
[rank0]:   File "/root/miniconda3/lib/python3.13/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
[rank0]:     data = self._next_data()
[rank0]:   File "/root/miniconda3/lib/python3.13/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
[rank0]:     data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
[rank0]:   File "/root/miniconda3/lib/python3.13/site-packages/torch/utils/data/_utils/fetch.py", line 33, in fetch
[rank0]:     data.append(next(self.dataset_iter))
[rank0]:                 ~~~~^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/workspace/flow-matching/CoDA/flow-matching-qwen/data/data_loader.py", line 416, in __iter__
[rank0]:     dataset = self._get_dataset()
[rank0]:   File "/workspace/flow-matching/CoDA/flow-matching-qwen/data/data_loader.py", line 364, in _get_dataset
[rank0]:     self._dataset = create_pretrain_mixture(
[rank0]:                     ~~~~~~~~~~~~~~~~~~~~~~~^
[rank0]:         self.tokenizer,
[rank0]:         ^^^^^^^^^^^^^^^
[rank0]:     ...<3 lines>...
[rank0]:         self.seed + self.worker_id,
[rank0]:         ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:     )
[rank0]:     ^
[rank0]:   File "/workspace/flow-matching/CoDA/flow-matching-qwen/data/data_loader.py", line 300, in create_pretrain_mixture
[rank0]:     ds = load_single_dataset(config, tokenizer, max_length)
[rank0]:   File "/workspace/flow-matching/CoDA/flow-matching-qwen/data/data_loader.py", line 197, in load_single_dataset
[rank0]:     ds = load_dataset(
[rank0]:         config.path,
[rank0]:         **load_kwargs,
[rank0]:     )
[rank0]:   File "/root/miniconda3/lib/python3.13/site-packages/datasets/load.py", line 1397, in load_dataset
[rank0]:     builder_instance = load_dataset_builder(
[rank0]:         path=path,
[rank0]:     ...<10 lines>...
[rank0]:         **config_kwargs,
[rank0]:     )
[rank0]:   File "/root/miniconda3/lib/python3.13/site-packages/datasets/load.py", line 1137, in load_dataset_builder
[rank0]:     dataset_module = dataset_module_factory(
[rank0]:         path,
[rank0]:     ...<5 lines>...
[rank0]:         cache_dir=cache_dir,
[rank0]:     )
[rank0]:   File "/root/miniconda3/lib/python3.13/site-packages/datasets/load.py", line 1009, in dataset_module_factory
[rank0]:     ).get_module()
[rank0]:       ~~~~~~~~~~^^
[rank0]:   File "/root/miniconda3/lib/python3.13/site-packages/datasets/load.py", line 609, in get_module
[rank0]:     exported_dataset_infos = _dataset_viewer.get_exported_dataset_infos(
[rank0]:         dataset=self.name, commit_hash=self.commit_hash, token=self.download_config.token
[rank0]:     )
[rank0]:   File "/root/miniconda3/lib/python3.13/site-packages/datasets/utils/_dataset_viewer.py", line 71, in get_exported_dataset_infos
[rank0]:     info_response = get_session().get(
[rank0]:         url=dataset_viewer_info_url + dataset,
[rank0]:         headers=get_authentication_headers_for_url(config.HF_ENDPOINT + f"datasets/{dataset}", token=token),
[rank0]:         timeout=100.0,
[rank0]:     )
[rank0]:   File "/root/miniconda3/lib/python3.13/site-packages/requests/sessions.py", line 602, in get
[rank0]:     return self.request("GET", url, **kwargs)
[rank0]:            ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/root/miniconda3/lib/python3.13/site-packages/requests/sessions.py", line 589, in request
[rank0]:     resp = self.send(prep, **send_kwargs)
[rank0]:   File "/root/miniconda3/lib/python3.13/site-packages/requests/sessions.py", line 703, in send
[rank0]:     r = adapter.send(request, **kwargs)
[rank0]:   File "/root/miniconda3/lib/python3.13/site-packages/huggingface_hub/utils/_http.py", line 95, in send
[rank0]:     return super().send(request, *args, **kwargs)
[rank0]:            ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/root/miniconda3/lib/python3.13/site-packages/requests/adapters.py", line 644, in send
[rank0]:     resp = conn.urlopen(
[rank0]:         method=request.method,
[rank0]:     ...<9 lines>...
[rank0]:         chunked=chunked,
[rank0]:     )
[rank0]:   File "/root/miniconda3/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
[rank0]:     response = self._make_request(
[rank0]:         conn,
[rank0]:     ...<10 lines>...
[rank0]:         **response_kw,
[rank0]:     )
[rank0]:   File "/root/miniconda3/lib/python3.13/site-packages/urllib3/connectionpool.py", line 464, in _make_request
[rank0]:     self._validate_conn(conn)
[rank0]:     ~~~~~~~~~~~~~~~~~~~^^^^^^
[rank0]:   File "/root/miniconda3/lib/python3.13/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
[rank0]:     conn.connect()
[rank0]:     ~~~~~~~~~~~~^^
[rank0]:   File "/root/miniconda3/lib/python3.13/site-packages/urllib3/connection.py", line 753, in connect
[rank0]:     self.sock = sock = self._new_conn()
[rank0]:                        ~~~~~~~~~~~~~~^^
[rank0]:   File "/root/miniconda3/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
[rank0]:     sock = connection.create_connection(
[rank0]:         (self._dns_host, self.port),
[rank0]:     ...<2 lines>...
[rank0]:         socket_options=self.socket_options,
[rank0]:     )
[rank0]:   File "/root/miniconda3/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
[rank0]:     sock.connect(sa)
[rank0]:     ~~~~~~~~~~~~^^^^
[rank0]: KeyboardInterrupt
